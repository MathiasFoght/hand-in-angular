<section class="add-card">
  <header>
    <h1>Add New Credit Card</h1>
    <a routerLink="/home" class="link-back">Back</a>
  </header>

  <form [formGroup]="form" (ngSubmit)="submit()" novalidate>
    <div class="grid">
      <!-- Card number -->
      <label>
        <span>Card number *</span>
        <input
          formControlName="cardNumber"
          inputmode="numeric" pattern="\d*"
          (input)="digitsOnly($event, 'cardNumber')"
          placeholder="7–16 digits"
        />
        @if (touchedInvalid('cardNumber')) {
          <small class="error">
            @if (c('cardNumber').errors?.['required']) { Required }
            @if (c('cardNumber').errors?.['pattern'])  { Numbers only }
            @if (c('cardNumber').errors?.['minlength']){ At least 7 digits }
            @if (c('cardNumber').errors?.['maxlength']){ Up to 16 digits }
          </small>
        }
      </label>

      <label>
        <span>Cardholder name *</span>
        <input formControlName="cardHolderName" placeholder="Full name" />
        @if (touchedInvalid('cardHolderName')) {
          <small class="error">Required.</small>
        }
      </label>

      <label>
        <span>CSC (3 digits) *</span>
        <input
          formControlName="cscCode"
          inputmode="numeric" pattern="\d{3}"
          maxlength="3"
          (input)="digitsOnly($event, 'cscCode')"
          placeholder="123"
        />
        @if (touchedInvalid('cscCode')) {
          <small class="error">
            @if (c('cscCode').errors?.['required']) { Required. }
            @if (c('cscCode').errors?.['pattern'])  { Must be exactly 3 digits. }
          </small>
        }
      </label>

      <label>
        <span>Expiration month (1–12) *</span>
        <input
          formControlName="expirationMonth"
          type="number" min="1" max="12" step="1"
          placeholder="MM"
        />
        @if (touchedInvalid('expirationMonth')) {
          <small class="error">
            @if (c('expirationMonth').errors?.['required']) { Required. }
            @if (c('expirationMonth').errors?.['min'] || c('expirationMonth').errors?.['max']) {
              Must be in range 1–12.
            }
          </small>
        }
      </label>

      <label>
        <span>Expiration year *</span>
        <input
          formControlName="expirationYear"
          type="number" step="1"
          placeholder="YYYY"
        />
        @if (touchedInvalid('expirationYear')) {
          <small class="error">Required.</small>
        }
      </label>

      <label>
        <span>Issuer *</span>
        <select formControlName="issuer">
          <option value="" disabled selected>Select issuer</option>
          <option value="Visa">Visa</option>
          <option value="Mastercard">Mastercard</option>
          <option value="Amex">Amex</option>
          <option value="Discover">Discover</option>
          <option value="Tarjeta Shopping">Tarjeta Shopping</option>
          <option value="Nativa">Nativa</option>
          <option value="Naranja">Naranja</option>
          <option value="JCB">JCB</option>
          <option value="Hipercard">Hipercard</option>
          <option value="ELO">ELO</option>
          <option value="China Union Pay">China Union Pay</option>
          <option value="Cencosud">Cencosud</option>
          <option value="Cabal">Cabal</option>
          <option value="Argencard">Argencard</option>
        </select>
        @if (touchedInvalid('issuer')) {
          <small class="error">Required.</small>
        }
      </label>
    </div>

    <div class="actions">
      <button type="submit" [disabled]="form.invalid">Save card</button>
      <a routerLink="/home" class="btn-secondary">Cancel</a>
    </div>
  </form>
</section>
